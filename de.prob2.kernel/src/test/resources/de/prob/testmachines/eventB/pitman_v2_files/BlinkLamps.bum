<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<org.eventb.core.machineFile org.eventb.core.configuration="org.eventb.core.fwd" org.eventb.core.generated="false" org.eventb.texttools.text_lastmodified="1579020054814" org.eventb.texttools.text_representation="machine BlinkLamps&#10;sees c0&#10;variables active_blinkers&#10; blinkLeft blinkRight&#10; remaining_blinks&#10; onCycle&#10;invariants&#10; @inv1 active_blinkers ⊆ BLINK_DIRECTION&#10; @inv2  blinkLeft∈ LAMP_STATUS ∧ blinkRight ∈ LAMP_STATUS&#10; @inv3 remaining_blinks∈BLINK_CYCLE_COUNTER&#10; @inv4 onCycle∈BOOL&#10;&#10; @SAF1&#10;  ((remaining_blinks=0 ∧ (blinkLeft=lamp_off ∧ blinkRight=lamp_off)) ⇔ active_blinkers = ∅)&#10;&#10; @SAF2&#10;  (blinkRight≠lamp_off ⇒ right_blink∈active_blinkers)   // strengthened after finding issue with VisB&#10;&#10; @SAF3 (blinkLeft≠lamp_off  ⇒ left_blink∈active_blinkers)   // ditto&#10;&#10; @SAF4 (active_blinkers=BLINK_DIRECTION ⇒ blinkLeft=blinkRight)  // invariant added after finding issue with VisB&#10;&#10; @SAF5&quot; (onCycle=FALSE ⇒ (blinkLeft=lamp_off ∧ blinkRight=lamp_off))&#10;&#10;  @SAF6&quot; (onCycle=TRUE ∧ active_blinkers ≠∅ ⇒ ¬(blinkLeft=lamp_off ∧ blinkRight=lamp_off))&#10;events&#10;  event INITIALISATION then&#10;    @ini1 active_blinkers ≔ ∅&#10;    @ini2  blinkLeft,blinkRight ≔ lamp_off,lamp_off&#10;    @ini3 remaining_blinks ≔ 0&#10;    @ini4 onCycle ≔ FALSE&#10;  end&#10;&#10;  event SET_AllBlinkersOff begin&#10;&#9;@act1 active_blinkers ≔ ∅&#10;&#9;@act2 remaining_blinks ≔ 0&#10;&#9;@act3 blinkLeft ≔ lamp_off&#10;&#9;@act4 blinkRight ≔ lamp_off&#10;  end&#10;&#10;  event SET_AllBlinkersOn begin&#10;&#9;@act1 active_blinkers ≔ BLINK_DIRECTION&#10;&#9;@act2 remaining_blinks ≔ continuousBlink&#10;&#9;@act3 blinkLeft ≔ cycleMaxLampStatus(onCycle)&#10;&#9;@act4 blinkRight ≔ cycleMaxLampStatus(onCycle)&#10;  end&#10;&#10;  event SET_LeftBlinkersOn any rem&#10;   where @grd1 rem∈BLINK_CYCLE_COUNTER&#10;         @grd2 rem ≠ 0&#10;   then&#10;&#9;@act1 active_blinkers ≔ {left_blink}&#10;&#9;@act2 remaining_blinks ≔ rem&#10;&#9;@act3 blinkLeft ≔ cycleMaxLampStatus(onCycle)&#10;&#9;@act4 blinkRight ≔ lamp_off&#10;  end&#10;&#10;  event SET_RightBlinkersOn any rem&#10;   where @grd1 rem∈BLINK_CYCLE_COUNTER&#10;         @grd2 rem ≠ 0&#10;   then&#10;&#9;@act1 active_blinkers ≔ {right_blink}&#10;&#9;@act2 remaining_blinks ≔ rem&#10;&#9;@act3 blinkRight ≔ cycleMaxLampStatus(onCycle)&#10;&#9;@act4 blinkLeft ≔ lamp_off&#10;  end&#10;&#10;  event SET_RemainingBlinks&#10;   any rem&#10;   where @grd1 rem∈BLINK_CYCLE_COUNTER&#10;         @grd2 rem ≠ 0&#10;         @grd3 remaining_blinks ≠ 0&#10;   then&#10;   @act1 remaining_blinks ≔ rem&#10;  end&#10;&#10;  event  TIME_BlinkerOn&#10;   when&#10;     @grd1 (blinkLeft=lamp_off ∧ blinkRight=lamp_off)&#10;     @grd2 remaining_blinks ≠ 0&#10;   then&#10;    @act1 blinkLeft ≔ {TRUE↦lamp_on,FALSE↦lamp_off}(bool(left_blink∈active_blinkers))&#10;    @act2 blinkRight ≔ {TRUE↦lamp_on,FALSE↦lamp_off}(bool(right_blink∈active_blinkers))&#10;    @act3 remaining_blinks ≔ max({continuousBlink,remaining_blinks−1})&#10;    @act4 onCycle ≔ TRUE&#10;  end&#10;&#10;  event  TIME_BlinkerOff&#10;   when&#10;     @grd1 ¬(blinkLeft=lamp_off ∧ blinkRight=lamp_off)&#10;   then&#10;    @act1 blinkLeft,blinkRight ≔ lamp_off, lamp_off&#10;    @act2 active_blinkers ≔ {x∣x∈active_blinkers ∧ remaining_blinks ≠ 0}&#10;     // one encoding of IF ...&#10;    @act3 onCycle ≔ FALSE&#10;  end&#10;&#10;&#10; event TIME_Nothing any newOnCycle where&#10;  @grd1 newOnCycle ≠ onCycle&#10;  @grd2 (blinkLeft=lamp_off ∧ blinkRight=lamp_off)&#10;  @grd3 active_blinkers=∅&#10;  then&#10;    @act1 onCycle ≔ newOnCycle&#10;   end&#10;end&#10;" version="5">
<org.eventb.core.seesContext name="_SYTK8DYEEeqmRpe4wS5b2g" org.eventb.core.target="c0"/>
<org.eventb.core.event name="'" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="INITIALISATION">
<org.eventb.core.action name="_SYTK8TYEEeqmRpe4wS5b2g" org.eventb.core.assignment="active_blinkers ≔ ∅" org.eventb.core.generated="false" org.eventb.core.label="ini1"/>
<org.eventb.core.action name="_ejFFwDYEEeqmRpe4wS5b2g" org.eventb.core.assignment="blinkLeft,blinkRight ≔ lamp_off,lamp_off" org.eventb.core.generated="false" org.eventb.core.label="ini2"/>
<org.eventb.core.action name="_IpwzoDYFEeqmRpe4wS5b2g" org.eventb.core.assignment="remaining_blinks ≔ 0" org.eventb.core.generated="false" org.eventb.core.label="ini3"/>
<org.eventb.core.action name="_55VCIDbpEeqW9sHxErWLyA" org.eventb.core.assignment="onCycle ≔ FALSE" org.eventb.core.generated="false" org.eventb.core.label="ini4"/>
</org.eventb.core.event>
<org.eventb.core.variable name="_SYTK8jYEEeqmRpe4wS5b2g" org.eventb.core.generated="false" org.eventb.core.identifier="active_blinkers"/>
<org.eventb.core.invariant name="_US_WADYEEeqmRpe4wS5b2g" org.eventb.core.generated="false" org.eventb.core.label="inv1" org.eventb.core.predicate="active_blinkers ⊆ BLINK_DIRECTION"/>
<org.eventb.core.variable name="_ejFFwTYEEeqmRpe4wS5b2g" org.eventb.core.generated="false" org.eventb.core.identifier="blinkLeft"/>
<org.eventb.core.variable name="_ejFFwjYEEeqmRpe4wS5b2g" org.eventb.core.generated="false" org.eventb.core.identifier="blinkRight"/>
<org.eventb.core.invariant name="_ejFFwzYEEeqmRpe4wS5b2g" org.eventb.core.generated="false" org.eventb.core.label="inv2" org.eventb.core.predicate="blinkLeft∈ LAMP_STATUS ∧ blinkRight ∈ LAMP_STATUS"/>
<org.eventb.core.event name="_M3lBMDawEeqW9sHxErWLyA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="SET_AllBlinkersOff">
<org.eventb.core.action name="_-snOAzYEEeqmRpe4wS5b2g" org.eventb.core.assignment="active_blinkers ≔ ∅" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_-snOBDYEEeqmRpe4wS5b2g" org.eventb.core.assignment="remaining_blinks ≔ 0" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_SMNaQTYFEeqmRpe4wS5b2g" org.eventb.core.assignment="blinkLeft ≔ lamp_off" org.eventb.core.generated="false" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_SMNaQjYFEeqmRpe4wS5b2g" org.eventb.core.assignment="blinkRight ≔ lamp_off" org.eventb.core.generated="false" org.eventb.core.label="act4"/>
</org.eventb.core.event>
<org.eventb.core.event name="_SMNaQDYFEeqmRpe4wS5b2g" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="SET_AllBlinkersOn">
<org.eventb.core.action name="_SMNaQzYFEeqmRpe4wS5b2g" org.eventb.core.assignment="active_blinkers ≔ BLINK_DIRECTION" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_SMNaRDYFEeqmRpe4wS5b2g" org.eventb.core.assignment="remaining_blinks ≔ continuousBlink" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_zTfkMDYFEeqmRpe4wS5b2g" org.eventb.core.assignment="blinkLeft ≔ cycleMaxLampStatus(onCycle)" org.eventb.core.generated="false" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_M3mPUDawEeqW9sHxErWLyA" org.eventb.core.assignment="blinkRight ≔ cycleMaxLampStatus(onCycle)" org.eventb.core.generated="false" org.eventb.core.label="act4"/>
</org.eventb.core.event>
<org.eventb.core.event name="_DRT_oDayEeqW9sHxErWLyA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="SET_LeftBlinkersOn">
<org.eventb.core.parameter name="_tNpJkTawEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.identifier="rem"/>
<org.eventb.core.guard name="_-snOATYEEeqmRpe4wS5b2g" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="rem∈BLINK_CYCLE_COUNTER"/>
<org.eventb.core.guard name="_-snOAjYEEeqmRpe4wS5b2g" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="rem ≠ 0"/>
<org.eventb.core.action name="_zTfkMzYFEeqmRpe4wS5b2g" org.eventb.core.assignment="active_blinkers ≔ {left_blink}" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_zTfkNDYFEeqmRpe4wS5b2g" org.eventb.core.assignment="remaining_blinks ≔ rem" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_M3m2YDawEeqW9sHxErWLyA" org.eventb.core.assignment="blinkLeft ≔ cycleMaxLampStatus(onCycle)" org.eventb.core.generated="false" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_IumHsDayEeqW9sHxErWLyA" org.eventb.core.assignment="blinkRight ≔ lamp_off" org.eventb.core.generated="false" org.eventb.core.label="act4"/>
</org.eventb.core.event>
<org.eventb.core.event name="_uhzOMDayEeqW9sHxErWLyA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="SET_RightBlinkersOn">
<org.eventb.core.parameter name="_DRUmsDayEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.identifier="rem"/>
<org.eventb.core.guard name="_zTfkMTYFEeqmRpe4wS5b2g" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="rem∈BLINK_CYCLE_COUNTER"/>
<org.eventb.core.guard name="_zTfkMjYFEeqmRpe4wS5b2g" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="rem ≠ 0"/>
<org.eventb.core.action name="_M3ndcDawEeqW9sHxErWLyA" org.eventb.core.assignment="active_blinkers ≔ {right_blink}" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_M3ndcTawEeqW9sHxErWLyA" org.eventb.core.assignment="remaining_blinks ≔ rem" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_IumuwDayEeqW9sHxErWLyA" org.eventb.core.assignment="blinkRight ≔ cycleMaxLampStatus(onCycle)" org.eventb.core.generated="false" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_uhzOMTayEeqW9sHxErWLyA" org.eventb.core.assignment="blinkLeft ≔ lamp_off" org.eventb.core.generated="false" org.eventb.core.label="act4"/>
</org.eventb.core.event>
<org.eventb.core.event name="_tNpJkDawEeqW9sHxErWLyA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="SET_RemainingBlinks">
<org.eventb.core.parameter name="_uhzOMjayEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.identifier="rem"/>
<org.eventb.core.guard name="_tNpwoTawEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="rem∈BLINK_CYCLE_COUNTER"/>
<org.eventb.core.guard name="_tNpwojawEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="rem ≠ 0"/>
<org.eventb.core.guard name="_pv6B8DaxEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="grd3" org.eventb.core.predicate="remaining_blinks ≠ 0"/>
<org.eventb.core.action name="_tNpwoDawEeqW9sHxErWLyA" org.eventb.core.assignment="remaining_blinks ≔ rem" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
</org.eventb.core.event>
<org.eventb.core.event name="_zTe9IDYFEeqmRpe4wS5b2g" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="TIME_BlinkerOn">
<org.eventb.core.guard name="_DRVNwDayEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="(blinkLeft=lamp_off ∧ blinkRight=lamp_off)"/>
<org.eventb.core.guard name="_dBR9wDayEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="remaining_blinks ≠ 0"/>
<org.eventb.core.action name="_DRVNwTayEeqW9sHxErWLyA" org.eventb.core.assignment="blinkLeft ≔ {TRUE↦lamp_on,FALSE↦lamp_off}(bool(left_blink∈active_blinkers))" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_DRVNwjayEeqW9sHxErWLyA" org.eventb.core.assignment="blinkRight ≔ {TRUE↦lamp_on,FALSE↦lamp_off}(bool(right_blink∈active_blinkers))" org.eventb.core.generated="false" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_uhz1QDayEeqW9sHxErWLyA" org.eventb.core.assignment="remaining_blinks ≔ max({continuousBlink,remaining_blinks−1})" org.eventb.core.generated="false" org.eventb.core.label="act3"/>
<org.eventb.core.action name="_SAGN0DbqEeqW9sHxErWLyA" org.eventb.core.assignment="onCycle ≔ TRUE" org.eventb.core.generated="false" org.eventb.core.label="act4"/>
</org.eventb.core.event>
<org.eventb.core.event name="_-snOADYEEeqmRpe4wS5b2g" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="TIME_BlinkerOff">
<org.eventb.core.guard name="_uhz1QTayEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="¬(blinkLeft=lamp_off ∧ blinkRight=lamp_off)"/>
<org.eventb.core.action name="_uhz1QzayEeqW9sHxErWLyA" org.eventb.core.assignment="blinkLeft,blinkRight ≔ lamp_off, lamp_off" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
<org.eventb.core.action name="_uhz1RDayEeqW9sHxErWLyA" org.eventb.core.assignment="active_blinkers ≔ {x∣x∈active_blinkers ∧ remaining_blinks ≠ 0}" org.eventb.core.comment="one encoding of IF ..." org.eventb.core.generated="false" org.eventb.core.label="act2"/>
<org.eventb.core.action name="_NB4AUDbqEeqW9sHxErWLyA" org.eventb.core.assignment="onCycle ≔ FALSE" org.eventb.core.generated="false" org.eventb.core.label="act3"/>
</org.eventb.core.event>
<org.eventb.core.variable name="_IpwzoTYFEeqmRpe4wS5b2g" org.eventb.core.generated="false" org.eventb.core.identifier="remaining_blinks"/>
<org.eventb.core.invariant name="_IpwzojYFEeqmRpe4wS5b2g" org.eventb.core.generated="false" org.eventb.core.label="inv3" org.eventb.core.predicate="remaining_blinks∈BLINK_CYCLE_COUNTER"/>
<org.eventb.core.invariant name="_55WQQDbpEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="inv4" org.eventb.core.predicate="onCycle∈BOOL"/>
<org.eventb.core.invariant name="_b_kUADawEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="SAF1&#10;" org.eventb.core.predicate="((remaining_blinks=0 ∧ (blinkLeft=lamp_off ∧ blinkRight=lamp_off)) ⇔ active_blinkers = ∅)"/>
<org.eventb.core.invariant name="_b_kUATawEeqW9sHxErWLyA" org.eventb.core.comment="strengthened after finding issue with VisB" org.eventb.core.generated="false" org.eventb.core.label="SAF2&#10;" org.eventb.core.predicate="(blinkRight≠lamp_off ⇒ right_blink∈active_blinkers)"/>
<org.eventb.core.invariant name="_b_kUAjawEeqW9sHxErWLyA" org.eventb.core.comment="ditto" org.eventb.core.generated="false" org.eventb.core.label="SAF3" org.eventb.core.predicate="(blinkLeft≠lamp_off  ⇒ left_blink∈active_blinkers)"/>
<org.eventb.core.invariant name="_b_kUAzawEeqW9sHxErWLyA" org.eventb.core.comment="invariant added after finding issue with VisB" org.eventb.core.generated="false" org.eventb.core.label="SAF4" org.eventb.core.predicate="(active_blinkers=BLINK_DIRECTION ⇒ blinkLeft=blinkRight)"/>
<org.eventb.core.variable name="_55WQQTbpEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.identifier="onCycle"/>
<org.eventb.core.invariant name="_55WQQjbpEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="SAF5&quot;" org.eventb.core.predicate="(onCycle=FALSE ⇒ (blinkLeft=lamp_off ∧ blinkRight=lamp_off))"/>
<org.eventb.core.invariant name="_55W3UDbpEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="SAF6&quot;" org.eventb.core.predicate="(onCycle=TRUE ∧ active_blinkers ≠∅ ⇒ ¬(blinkLeft=lamp_off ∧ blinkRight=lamp_off))"/>
<org.eventb.core.event name="_NB4nYDbqEeqW9sHxErWLyA" org.eventb.core.convergence="0" org.eventb.core.extended="false" org.eventb.core.generated="false" org.eventb.core.label="TIME_Nothing">
<org.eventb.core.parameter name="_NB4nYTbqEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.identifier="newOnCycle"/>
<org.eventb.core.guard name="_NB4nYjbqEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="grd1" org.eventb.core.predicate="newOnCycle ≠ onCycle"/>
<org.eventb.core.guard name="_uhz1QjayEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="grd2" org.eventb.core.predicate="(blinkLeft=lamp_off ∧ blinkRight=lamp_off)"/>
<org.eventb.core.guard name="_NB4nZDbqEeqW9sHxErWLyA" org.eventb.core.generated="false" org.eventb.core.label="grd3" org.eventb.core.predicate="active_blinkers=∅"/>
<org.eventb.core.action name="_TJ4gYDbqEeqW9sHxErWLyA" org.eventb.core.assignment="onCycle ≔ newOnCycle" org.eventb.core.generated="false" org.eventb.core.label="act1"/>
</org.eventb.core.event>
</org.eventb.core.machineFile>
